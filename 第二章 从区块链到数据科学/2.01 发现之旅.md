# 2.1 发现之旅

**“越过山丘，才发现无人等候。”——李宗盛《山丘》**

从2016年起，我们思源参与了多个智慧城市的建设，这些项目依托于我们之前开发的移动化集成平台——“通”。“通”简单说，就是一种多账号管理系统、移动门户技术（名片）和即时通讯的总成，以标准化和协议化为基础，利用微服务技术整合各类服务。

一般来说，一个城市希望把所有政务办理和便民服务整合到一个应用或一个窗口中，通过这个应用入口，了解各类事项的办理情况，服务的使用情况，从而进一步提升政府的服务能力。但在实际工程实施中，逐渐发现，这不是一个信息工程，而是一个社会工程。每个平台都需要集成几百个子系统，各子系统又是多样化的，标准并不统一，同时，各个部门并不愿意将数据集中在一个平台上。过去十年，国家投入大量的人力物力，努力建设最大规模的数据整合平台，并出台了多种数据格式规范，但效果不彰。在这样的情况下，我当时设计了“事项网关”，“事项网关”是一种工程模型，核心的主张是，用户通过自己的权限访问各个分立的子系统，通过这些标准的数据接口，获得自己的数据，并将这些数据提交给其他的部门继续使用这些数据。当时，考虑到了数据加密和数据的授权，确保数据不在流通环节中泄漏，但实际的结果，基本上只能执行到数据获取的接口可以有效的管理起来，数据可以相互平滑调度的程度。因为，各个子系统如果要保护用户数据，都需要很多流程改造，成本太高。

由于无法在流程中加密隔离数据，就还是要基于统一用户体系，就是类似OpenID[^OpenID]的既有框架。OpenID是利用一个中心作为基础认证服务，其他子系统依据协议进行统一认证。但由于政府的服务是要求更高的安全等级，子系统又需要一些关键信息来确认用户，很难防范用户一些关键信息的泄漏。

当时正在研究区块链技术和人工智能技术，发现如果直接使用公私钥体系，就可以解决这个问题，后来看到FIDO等方案也是按这个思路实现的。

当时是摸着石头过河，为让公私钥可以实现身份认证和应用连接，我们建立了第一个连接协议“TAIP”（Trustless Application Integration Protocol）免信应用集成协议。这个协议的第一个版本的实现原理是，先让应用请求是二层封装的，第一层请求的是应用的TAIP代理服务，第二层是用户要访问的URL或接口。用户用自己的公钥向TAIP代理发出请求，代理服务会返回一个随机值或者叫临时Token。用户利用私钥加密这个临时令牌（Token），就是电子签名，和自己的公钥再次向代理服务发出请求，代理服务通过验签。确认是否是这个用户的合法请求，如果是合法请求，就根据二层的具体需求返回给用户授权URL。

传统的中心化认证，是用户将比对信息（如用户名，密码）提交给鉴权服务，鉴权服务利用这些数据和系统中的数据进行比对，比对正确，则返回给用户一个授权的URL，TAIP是用电子签名的方法，替代了比对信息的方法。

用签名方法实现，可以杜绝钓鱼攻击，也不会泄漏任何用户的信息，是比口令方式更加优秀的方法来确保用户的账户安全。

同时，利用公钥作为ID的好处在于，这是以用户为中心建立的鉴权系统，用户只要第一次和不同的服务建立认证关系，就可以持续方便的使用该服务，通用、安全、便利。

毕竟第一个版本需要两次请求，这样的效率不够好，那么如何一次请求就能实现呢？

我想到了利用数据本身的多维性和时间上不重复的特性，把请求本身变成临时令牌。

于是就诞生了CDTP协议（Crypto Data Transaction Protocol 密码学保障的数据交换协议，简称密保数据交换协议）。

后来，2018年看以色列举行的全球信息安全峰会的论文时，发现当年最核心的话题时“非交互式零知识证明”（Non-Interactive Zero Knowledge Proof），这是一个全球的技术热点和关键问题。如果能有办法解决这个问题，则可以全面提升目前信息网络的安全程度。

对于信息安全领域来说，密码学是构建现代信息安全的核心。所谓量子通讯，就是利用量子纠缠理论，在信息交换对象的双方构建一个只有双方知道的密钥，这个密钥无需借用其他的通道进行协商，这才能做到理论上无懈可击的安全。

目前大多数安全系统，都不是理论上的安全，而是利用工程加入足够的干扰，或物理的隔离隐藏来实现。每个方法都依赖一系列的工程基础设备，操作系统，算法，网络的特殊结构，在安全审计和工程实践上，不具备简明性和可证性。

而基于非对称加密算法保障的信息安全或量子安全都是理论上可以论证的安全，唯一的隐患是信息的接收端，这个端叫End，指的是密码学保障的信息安全到此为止，End是密码学控制的边界，也是密文和明文转化的界面。

通过对这些问题的了解，给了自己一个意外的惊喜，就是在工程中找到了非交互零知识证明的解决方案或在信息交换领域的答案。

同时，也对信息安全的本质有了进一步的认识。

第一点，基于加解密的算法，是让信息在传递和存储时，唯一的理论上可以保障的安全方法。但本质上，这是概率意义的加密，只是破解的概率很低，不存在不被破解的信息。

第二点，加解密的算法是很难不公开的，基于密码学的信息安全，首先要假设算法是公开的。在有些系统中，把算法固化在芯片里利用设备进行保护或用其他方式隐匿算法，是工程上的安全设计不是理论上安全设计。

第三点，如果算法是公开的，只有彻底不传输密钥，才可能在理论上保障信息安全。量子密码是不传输密钥的并且密钥的生成是真随机的，非对称加密也是不传输密钥的并确保无法通过公钥推算出私钥，非对称加密算法由于公开了公钥，只要不能通过公钥算出在大概率上私钥，就是理论安全的。

所以说，密码学推动的是理论安全，而大多数现有的信息系统多数是工程安全。

而比特币，利用非对称加密算法构造的用户系统，经历了十年，没有出现致命的安全隐患，正是理论安全保障的。

之所以之前的系统没有按这个思路来做，除了习惯的原因，没有经过足够规模的实践验证的理论，大家还是不敢轻易尝试的。

[^OpenID]: 是一个去中心化的网上身份认证系统。对于支持OpenID的网站，用户不需要记住像用户名和密码这样的传统验证标记。取而代之的是，他们只需要预先在一个作为OpenID身份提供者（identity provider, IdP）的网站上注册。OpenID是去中心化的，任何网站都可以使用OpenID来作为用户登录的一种方式，任何网站也都可以作为OpenID身份提供者。OpenID既解决了问题而又不需要依赖于中心性的网站来确认数字身份。
